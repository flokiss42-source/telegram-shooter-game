<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéØ Target Shooter</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #0f0c29, #302b63);
            color: white;
            overflow: hidden;
            height: 100vh;
        }
        
        #game {
            width: 100%;
            height: 100vh;
            position: relative;
            cursor: crosshair;
        }
        
        .target {
            position: absolute;
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.2s;
            box-shadow: 0 0 15px rgba(255,255,255,0.5);
        }
        
        .target:hover {
            transform: scale(1.1);
        }
        
        #score {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 28px;
            background: rgba(0,0,0,0.7);
            padding: 15px;
            border-radius: 10px;
            z-index: 100;
        }
        
        #timer {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 28px;
            background: rgba(0,0,0,0.7);
            padding: 15px;
            border-radius: 10px;
            z-index: 100;
        }
        
        #gameOver {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        #finalScore {
            font-size: 72px;
            color: #ffa502;
            margin: 20px 0;
            text-shadow: 0 0 10px #ffa502;
        }
        
        button {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            border: none;
            padding: 20px 40px;
            font-size: 24px;
            border-radius: 15px;
            cursor: pointer;
            margin: 15px;
            transition: all 0.3s;
            font-weight: bold;
        }
        
        button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px #ff6b6b;
        }
        
        .hit-effect {
            position: absolute;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            pointer-events: none;
            animation: hitAnimation 0.5s forwards;
            z-index: 50;
        }
        
        @keyframes hitAnimation {
            0% { transform: scale(0); opacity: 1; }
            100% { transform: scale(2); opacity: 0; }
        }
        
        .score-popup {
            position: absolute;
            font-size: 32px;
            font-weight: bold;
            pointer-events: none;
            animation: popupAnimation 1s forwards;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            z-index: 60;
        }
        
        @keyframes popupAnimation {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            100% { transform: translateY(-60px) scale(1.3); opacity: 0; }
        }
        
        #instructions {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(0,0,0,0.7);
            padding: 15px;
            border-radius: 10px;
            font-size: 16px;
            max-width: 300px;
            z-index: 100;
        }
        
        #hits {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(0,0,0,0.7);
            padding: 15px;
            border-radius: 10px;
            font-size: 16px;
            z-index: 100;
        }
    </style>
</head>
<body>
    <div id="game">
        <div id="score">üéØ –û—á–∫–∏: <span id="scoreValue">0</span></div>
        <div id="timer">‚è±Ô∏è <span id="timeValue">30</span>—Å</div>
        <div id="hits">‚úÖ –ü–æ–ø–∞–¥–∞–Ω–∏–π: <span id="hitsValue">0</span></div>
        
        <div id="instructions">
            üéØ –¶–µ–ª–∏:<br>
            üî¥ +100 üü¶ +50 üü¢ +25<br>
            ‚ö™ -50 (–º–∏—Ä–Ω—ã–π –∂–∏—Ç–µ–ª—å)
        </div>
        
        <div id="gameOver">
            <h1 style="font-size: 48px; margin-bottom: 20px;">üéÆ –ò–ì–†–ê –û–ö–û–ù–ß–ï–ù–ê!</h1>
            <div id="finalScore">0</div>
            <div id="finalStats" style="font-size: 24px; margin-bottom: 30px;">–¢–æ—á–Ω–æ—Å—Ç—å: 0%</div>
            <button onclick="restartGame()">üîÑ –ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
            <button onclick="sendToTelegram()">üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç</button>
        </div>
    </div>

    <script>
        // Telegram Web App API
        const tg = window.Telegram.WebApp;
        
        // –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let score = 0;
        let timeLeft = 30;
        let gameActive = true;
        let hits = 0;
        let totalShots = 0;
        let gameInterval;
        let targets = [];
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const scoreElement = document.getElementById('scoreValue');
        const timeElement = document.getElementById('timeValue');
        const hitsElement = document.getElementById('hitsValue');
        const gameArea = document.getElementById('game');
        const gameOverScreen = document.getElementById('gameOver');
        const finalScoreElement = document.getElementById('finalScore');
        const finalStatsElement = document.getElementById('finalStats');
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            score = 0;
            timeLeft = 30;
            gameActive = true;
            hits = 0;
            totalShots = 0;
            targets = [];
            
            // –û—á–∏—Å—Ç–∫–∞
            scoreElement.textContent = score;
            timeElement.textContent = timeLeft;
            hitsElement.textContent = hits;
            gameOverScreen.style.display = 'none';
            
            // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ —Ü–µ–ª–∏
            const oldTargets = document.querySelectorAll('.target');
            oldTargets.forEach(t => t.remove());
            
            // –°–æ–∑–¥–∞–µ–º —Ü–µ–ª–∏
            createTargets();
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä
            clearInterval(gameInterval);
            gameInterval = setInterval(updateGame, 1000);
            
            // Telegram Web App –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
            if (tg) {
                tg.ready();
                tg.expand();
                tg.enableClosingConfirmation();
            }
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–π
        function createTargets() {
            const targetCount = 6;
            
            for (let i = 0; i < targetCount; i++) {
                setTimeout(() => createTarget(), i * 300);
            }
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –æ–¥–Ω–æ–π —Ü–µ–ª–∏
        function createTarget() {
            if (!gameActive || targets.length >= 10) return;
            
            const target = document.createElement('div');
            target.className = 'target';
            
            // –¢–∏–ø—ã —Ü–µ–ª–µ–π
            const targetTypes = [
                { color: '#ff4757', points: 100, size: 70 },   // –ö—Ä–∞—Å–Ω–∞—è
                { color: '#3742fa', points: 50, size: 65 },    // –°–∏–Ω—è—è
                { color: '#2ed573', points: 25, size: 60 },    // –ó–µ–ª–µ–Ω–∞—è
                { color: '#f1f2f6', points: -50, size: 65 }    // –ú–∏—Ä–Ω–∞—è
            ];
            
            const type = targetTypes[Math.floor(Math.random() * targetTypes.length)];
            
            // –†–∞–∑–º–µ—Ä –∏ –ø–æ–∑–∏—Ü–∏—è
            const size = type.size;
            target.style.width = size + 'px';
            target.style.height = size + 'px';
            target.style.background = `radial-gradient(circle at 30% 30%, ${type.color}, #000)`;
            target.dataset.points = type.points;
            
            // –ü–æ–∑–∏—Ü–∏—è
            const x = Math.random() * (window.innerWidth - size);
            const y = 70 + Math.random() * (window.innerHeight - size - 150);
            target.style.left = x + 'px';
            target.style.top = y + 'px';
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞
            target.onclick = function(e) {
                e.stopPropagation();
                shootTarget(this);
            };
            
            target.ontouchstart = function(e) {
                e.preventDefault();
                e.stopPropagation();
                shootTarget(this);
            };
            
            gameArea.appendChild(target);
            targets.push(target);
            
            // –ê–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 3-5 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                if (target.parentNode) {
                    target.remove();
                    targets = targets.filter(t => t !== target);
                    if (gameActive) createTarget();
                }
            }, 3000 + Math.random() * 2000);
        }
        
        // –°—Ç—Ä–µ–ª—å–±–∞ –ø–æ —Ü–µ–ª–∏
        function shootTarget(target) {
            if (!gameActive) return;
            
            totalShots++;
            
            const points = parseInt(target.dataset.points);
            score += points;
            
            if (points > 0) {
                hits++;
                hitsElement.textContent = hits;
            }
            
            scoreElement.textContent = score;
            
            // –≠—Ñ—Ñ–µ–∫—Ç –ø–æ–ø–∞–¥–∞–Ω–∏—è
            createHitEffect(target, points > 0 ? '#00ff00' : '#ff0000');
            
            // –ü–æ–ø–∞–ø —Å –æ—á–∫–∞–º–∏
            createScorePopup(target, points);
            
            // –£–¥–∞–ª—è–µ–º —Ü–µ–ª—å
            target.remove();
            targets = targets.filter(t => t !== target);
            
            // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é —Ü–µ–ª—å
            if (gameActive) {
                setTimeout(() => createTarget(), 500);
            }
        }
        
        // –≠—Ñ—Ñ–µ–∫—Ç –ø–æ–ø–∞–¥–∞–Ω–∏—è
        function createHitEffect(target, color) {
            const effect = document.createElement('div');
            effect.className = 'hit-effect';
            effect.style.background = `radial-gradient(circle, ${color}, transparent)`;
            effect.style.left = (target.offsetLeft - 10) + 'px';
            effect.style.top = (target.offsetTop - 10) + 'px';
            
            gameArea.appendChild(effect);
            setTimeout(() => effect.remove(), 500);
        }
        
        // –ü–æ–ø–∞–ø —Å –æ—á–∫–∞–º–∏
        function createScorePopup(target, points) {
            const popup = document.createElement('div');
            popup.className = 'score-popup';
            popup.textContent = (points > 0 ? '+' : '') + points;
            popup.style.color = points > 0 ? '#ffa502' : '#ff4757';
            popup.style.left = (target.offsetLeft + 25) + 'px';
            popup.style.top = (target.offsetTop - 20) + 'px';
            
            gameArea.appendChild(popup);
            setTimeout(() => popup.remove(), 1000);
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–≥—Ä—ã
        function updateGame() {
            if (!gameActive) return;
            
            timeLeft--;
            timeElement.textContent = timeLeft;
            
            if (timeLeft <= 0) {
                endGame();
            }
        }
        
        // –ö–æ–Ω–µ—Ü –∏–≥—Ä—ã
        function endGame() {
            gameActive = false;
            clearInterval(gameInterval);
            
            // –£–¥–∞–ª—è–µ–º –≤—Å–µ —Ü–µ–ª–∏
            targets.forEach(target => {
                if (target.parentNode) target.remove();
            });
            targets = [];
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            const accuracy = totalShots > 0 ? Math.round((hits / totalShots) * 100) : 0;
            finalScoreElement.textContent = score;
            finalStatsElement.textContent = `–¢–æ—á–Ω–æ—Å—Ç—å: ${accuracy}%, –ü–æ–ø–∞–¥–∞–Ω–∏–π: ${hits}/${totalShots}`;
            gameOverScreen.style.display = 'flex';
        }
        
        // –†–µ—Å—Ç–∞—Ä—Ç –∏–≥—Ä—ã
        function restartGame() {
            initGame();
        }
        
        // –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram
        function sendToTelegram() {
            const accuracy = totalShots > 0 ? Math.round((hits / totalShots) * 100) : 0;
            
            const gameData = {
                score: score,
                hits: hits,
                shots: totalShots,
                accuracy: accuracy,
                time: 30 - timeLeft
            };
            
            if (tg && tg.sendData) {
                tg.sendData(JSON.stringify(gameData));
            } else {
                // –î–ª—è —Ç–µ—Å—Ç–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
                alert(`–ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!\n–û—á–∫–∏: ${score}\n–¢–æ—á–Ω–æ—Å—Ç—å: ${accuracy}%`);
            }
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º Web App
            if (tg && tg.close) {
                tg.close();
            }
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–º–∞—Ö–æ–≤
        gameArea.onclick = function(e) {
            if (!gameActive || e.target.className === 'target') return;
            totalShots++;
        };
        
        gameArea.ontouchstart = function(e) {
            if (!gameActive || e.target.className === 'target') return;
            totalShots++;
        };
        
        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
        window.onload = initGame;
        window.onresize = function() {
            // –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–µ–º —Ü–µ–ª–∏
            if (gameActive) {
                targets.forEach(t => t.remove());
                targets = [];
                createTargets();
            }
        };
    </script>
</body>
</html>
